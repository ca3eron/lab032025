---
title: "Lab 03 - Take a sad plot and make it better"
author: "User1, User2, User3, User4, User5 and User6 - Team Name"
date: "`r Sys.Date()`"
output: html_document
---

### Load packages

```{r load-packages, message = FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
```


# Questioning data visualisations

## Image 1

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("img/Speaking-the-world.jpg")
```

_Write your comments about image 1 below_





## Image 2

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("img/rose-pop-density-total-area-bw.jpg")
```

_Write your comments about image 2 below_




## Image 3

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("img/life-expectancy-rule-of-law.png")
```

_Write your comments about image 3 below_




## Image 4

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("img/global-income-dist.PNG")
```

_Write your comments about image 4 below_





# Exercises

```{r load-data-staff, message=FALSE, eval=TRUE}
staff <- read_csv("data/instructional-staff.csv")
```


## Exercise 1

What is the difference between *wide format* data and *long format* data?


Is the format `staff` data *wide* or *long*?


How many observations are there in the data set?




## Exercise 2

```{r pivoting}
## Uncomment and complete the following code

staff_long <- staff %>%
  pivot_longer(
    cols = 2:12, 
    names_to = "year",
     values_to = "percent"
     )

```


## Exercise 3

```{r dot-plot}
# Write your code for Exercise 3 here
 view(staff_long)
 ggplot(data = staff_long,
        mapping = aes(x = year, 
                      y = percent, 
                     colour = faculty_type)) +
    geom_point() 

```

## Exercise 4

```{r bad-line-plot}
# Write your code for Exercise 4 here
ggplot(data = staff_long,
       mapping = aes(x = year, 
                     y = percent, 
                     colour = faculty_type)) +
  geom_line() 

#This doesn't work until after exercise 5 as the staff_long variable is a character not a numeric so therefore you can't visualise progression over dates as there is no year inbetween 1975 and 1989 for example. This is why indrxing didnt't work when pivoting.

```

## Exercise 5

```{r mutate-year}
## Uncomment and complete the following code

staff_long <- staff_long %>%
  mutate(year = as.numeric(year))
```


```{r working-line-plot}
# Write your code for Exercise 5 here
 view(staff_long)
 ggplot(data = staff_long,
        mapping = aes(x = year, 
                      y = percent, 
                     colour = faculty_type)) +
    geom_point() 

```

## Exercise 6

```{r better-line-plot}
# Write your code for Exercise 6 here
ggplot(data = staff_long,
       mapping = aes(x = year, 
                     y = percent, 
                     colour = faculty_type,
                     )) +
  labs(
    x = "year data was recorded",
    y = "percentage of workers who are in a particular emplopyment contract",
    title = "percentage of employees in respective employment contracts by year",
    subtitle = "Data contains years  1975-2011"
  ) +
  geom_line()

```

## Exercise 7

_Write below your ideas for adapting the line plot_

* You could make the part-time line coloured and the rest b+w to make it stand out visually
* Include how number of workers rather than percentage, it may be that they require more staff as the business grows etc rather than them changing the employment contract of firing other employment types.
* Calculate the difference/range between the lowest point an highest point of beginning/end 
* Pay 
* Materinty leave, could influence people going part-time
* Gender
* Age


## Exercise 8

```{r implement-Ex7}
# Write your code for Exercise 8 here
# Write your code for Exercise 6 here
ggplot(data = staff_long,
       mapping = aes(x = year, 
                     y = percent, 
                     colour = faculty_type,
                     )) +
  labs(
    x = "year data was recorded",
    y = "percentage of workers who are in a particular emplopyment contract",
    title = "percentage of employees in respective employment contracts by year",
    subtitle = "Data contains years  1975-2011"
  ) +
  geom_line()+
   scale_color_manual(values = c("Part-Time Faculty" = "blue", "Full-Time Tenured Faculty" = "black", "Full-Time Tenure-Track Faculty" = "black","Full-Time Non-Tenure-Track Faculty" = "black", "Full-Time Non-Tenure-Track Faculty" = "black", "Graduate Student Employees
" = "black"))


```

